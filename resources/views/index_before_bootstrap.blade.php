<!DOCTYPE html>
<html lang="{{ str_replace('_', '-', app()->getLocale()) }}">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>CT Sabah Lucky Draw 2022</title>

        <!-- Fonts -->
        <link href="https://fonts.bunny.net/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
        <link href="{{asset('css/bootstrap.min.css')}}" rel="stylesheet">


        <!-- Styles -->
        <style>
            /*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}a{background-color:transparent}[hidden]{display:none}html{font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5}*,:after,:before{box-sizing:border-box;border:0 solid #e2e8f0}a{color:inherit;text-decoration:inherit}svg,video{display:block;vertical-align:middle}video{max-width:100%;height:auto}.bg-white{--bg-opacity:1;background-color:#fff;background-color:rgba(255,255,255,var(--bg-opacity))}.bg-gray-100{--bg-opacity:1;background-color:#f7fafc;background-color:rgba(247,250,252,var(--bg-opacity))}.border-gray-200{--border-opacity:1;border-color:#edf2f7;border-color:rgba(237,242,247,var(--border-opacity))}.border-t{border-top-width:1px}.flex{display:flex}.grid{display:grid}.hidden{display:none}.items-center{align-items:center}.justify-center{justify-content:center}.font-semibold{font-weight:600}.h-5{height:1.25rem}.h-8{height:2rem}.h-16{height:4rem}.text-sm{font-size:.875rem}.text-lg{font-size:1.125rem}.leading-7{line-height:1.75rem}.mx-auto{margin-left:auto;margin-right:auto}.ml-1{margin-left:.25rem}.mt-2{margin-top:.5rem}.mr-2{margin-right:.5rem}.ml-2{margin-left:.5rem}.mt-4{margin-top:1rem}.ml-4{margin-left:1rem}.mt-8{margin-top:2rem}.ml-12{margin-left:3rem}.-mt-px{margin-top:-1px}.max-w-6xl{max-width:72rem}.min-h-screen{min-height:100vh}.overflow-hidden{overflow:hidden}.p-6{padding:1.5rem}.py-4{padding-top:1rem;padding-bottom:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.pt-8{padding-top:2rem}.fixed{position:fixed}.relative{position:relative}.top-0{top:0}.right-0{right:0}.shadow{box-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px 0 rgba(0,0,0,.06)}.text-center{text-align:center}.text-gray-200{--text-opacity:1;color:#edf2f7;color:rgba(237,242,247,var(--text-opacity))}.text-gray-300{--text-opacity:1;color:#e2e8f0;color:rgba(226,232,240,var(--text-opacity))}.text-gray-400{--text-opacity:1;color:#cbd5e0;color:rgba(203,213,224,var(--text-opacity))}.text-gray-500{--text-opacity:1;color:#a0aec0;color:rgba(160,174,192,var(--text-opacity))}.text-gray-600{--text-opacity:1;color:#718096;color:rgba(113,128,150,var(--text-opacity))}.text-gray-700{--text-opacity:1;color:#4a5568;color:rgba(74,85,104,var(--text-opacity))}.text-gray-900{--text-opacity:1;color:#1a202c;color:rgba(26,32,44,var(--text-opacity))}.underline{text-decoration:underline}.antialiased{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.w-5{width:1.25rem}.w-8{width:2rem}.w-auto{width:auto}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}@media (min-width:640px){.sm\:rounded-lg{border-radius:.5rem}.sm\:block{display:block}.sm\:items-center{align-items:center}.sm\:justify-start{justify-content:flex-start}.sm\:justify-between{justify-content:space-between}.sm\:h-20{height:5rem}.sm\:ml-0{margin-left:0}.sm\:px-6{padding-left:1.5rem;padding-right:1.5rem}.sm\:pt-0{padding-top:0}.sm\:text-left{text-align:left}.sm\:text-right{text-align:right}}@media (min-width:768px){.md\:border-t-0{border-top-width:0}.md\:border-l{border-left-width:1px}.md\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}}@media (min-width:1024px){.lg\:px-8{padding-left:2rem;padding-right:2rem}}@media (prefers-color-scheme:dark){.dark\:bg-gray-800{--bg-opacity:1;background-color:#2d3748;background-color:rgba(45,55,72,var(--bg-opacity))}.dark\:bg-gray-900{--bg-opacity:1;background-color:#1a202c;background-color:rgba(26,32,44,var(--bg-opacity))}.dark\:border-gray-700{--border-opacity:1;border-color:#4a5568;border-color:rgba(74,85,104,var(--border-opacity))}.dark\:text-white{--text-opacity:1;color:#fff;color:rgba(255,255,255,var(--text-opacity))}.dark\:text-gray-400{--text-opacity:1;color:#cbd5e0;color:rgba(203,213,224,var(--text-opacity))}.dark\:text-gray-500{--tw-text-opacity:1;color:#6b7280;color:rgba(107,114,128,var(--tw-text-opacity))}}
        </style>

        <css-doodle>
            <style>
            @grid: 50x1 / 50vmin;
            :container {
                perspective: 23vmin;
            }
            background: @m(
                @r(200, 240),
                radial-gradient(
                @p(#00b8a9, #f8f3d4, #f6416c, #ffde7d) 15%,
                transparent 50%
                ) @r(100%) @r(100%) / @r(1%, 3%) @lr no-repeat
            );

            @size: 80%;
            @place-cell: center;

            border-radius: 50%;
            transform-style: preserve-3d;
            animation: scale-up 20s linear infinite;
            animation-delay: calc(@i * -.4s);

            @keyframes scale-up {
                0% {
                opacity: 0;
                transform: translate3d(0, 0, 0) rotate(0);
                }
                10% {
                opacity: 1;
                }
                95% {
                transform:
                    translate3d(0, 0, @r(50vmin, 55vmin))
                    rotate(@r(-360deg, 360deg));
                }
                100% {
                opacity: 0;
                transform: translate3d(0, 0, 1vmin);
                }
            }
            </style>
        </css-doodle>

        <style>
            html, body {
                height: 100%;
                margin: 0;
                overflow: hidden;
                overflow: clip;
                contain: content;
            }

            body {
                display: flex;
                align-items: center;
                justify-content: center;
                background: #000;
            }

            .dGif {
                min-width: 250px;
                min-height: 250px;
                border-radius: 5%;
            }
            /* #ffd700 */
            /* #3399ff */

            h1, h2{
                text-align: center;
                color: white;
            }

            .tablewrapper{
                position: absolute;
                z-index: 2;
                width: 1920px;
                height: 1080px;
            }

            .gq{
                width:100%;
                height:100%;
            }

            /* Ini adalah Spinning Card */
            .blue {
                background: #5cele6;
                border-radius: 4px;
                display: flex;
                align-items: center;
                justify-content: center;
                /* box-shadow: 0 4px 7px 0 rgb(211, 247, 248), 0 6px 15px 0 rgb(189, 243, 245); */
                animation: rotate 5s cubic-bezier(0.54, 0.13, 0.3, 0.87);
                /* animation: rotate 3s cubic-bezier(0.33, 0.03, 0.03, 0.13); */
            }

            .gold {
                background: #5cele6;
                display: flex;
                align-items: center;
                justify-content: center;
                /* box-shadow: 0 4px 7px 0 rgb(211, 247, 248), 0 6px 15px 0 rgb(189, 243, 245); */
                /* animation: rotate 5s cubic-bezier(0.54, 0.13, 0.3, 0.87); */
                animation: gold_rotate 7s cubic-bezier(0.54, 0.13, 0.03, 1);
                /* opacity: 0;
                transition: opacity 1s;
                transition-delay: 5s; */
            }

            @keyframes rotate {
            0% {
                transform: rotateY(0turn);
            }
            100% {
                transform: rotateY(10turn);
            }
            }

            @keyframes gold_rotate {
            0% {
                transform: rotateY(0turn);
            }
            100% {
                transform: rotateY(50turn);
            }
            }

            /* Ini adalah bouncing button */
            .ud_solution {
                width: 90%;
                /* min-height: 100px;*/
                padding: 120px 0 0 0;
                float: left;
                position: relative;
                margin: 5% 5% 0 5%;
                background-size: cover;
                text-align: center;
            }
            .ud_solution:last-child {
                margin: 5%;
            }
            .ud_solution h2 {
                text-transform: uppercase;
                position: absolute;
                top: 15px;
                left: 40px;
                font-family: "Oswald", sans-serif;
                line-height: 25px;
                font-weight: 700;
                text-align: left;
            }
            .ud_solution h2 span {
                font-size: 15px;
                color: #ff6600;
                font-weight: 500;
            }

            .ud_button {
                font-family: "Oswald", sans-serif;
                top: 65%;
                left: 50%;
                transform: translateX(-50%) translateY(-50%);
            }

            #Button3 .ud_button {
                padding: 15px 25px 15px 25px;
                font-size: 20px;
                color: #fff;
                text-decoration: none;
                text-transform: uppercase;
                position: absolute;
                z-index: 2;
                display: block;
                width: 150px;
            }
            #Button3 .ud_button::before {
                z-index: -1;
                content: "";
                position: absolute;
                top: 0;
                right: 0;
                left: 0;
                bottom: 0;
                background: #111;
                border-radius: 30px;
            }
            #Button3 .ud_button::after {
                z-index: -2;
                content: "";
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: #3399ff;
                transform: scale(1, 1);
                border-radius: 20px;
            }
            #Button3 .ud_button:hover:after {
                animation: ease-in-out infinite 1000ms ud_bounce;
            }

            @keyframes ud_bounce {
            0% {
                transform: scale(1, 1);
            }
            50% {
                transform: scale(1.1, 1.3);
            }
            100% {
                transform: scale(1, 1);
            }
            }

            /* Shake Animation */

            .shake_gq {
                animation: shake 0.5s;
                animation-iteration-count: 5;
            }

            @keyframes shake {
                0% { transform: translate(1px, 1px) rotate(0deg); }
                10% {
                transform: translate(-1px, -2px) rotate(-2deg);
                background-color: #774212;}
                20% { transform: translate(-3px, 0px) rotate(2deg); }
                30% { transform: translate(3px, 2px) rotate(0deg); }
                40% { transform: translate(1px, -1px) rotate(2deg); }
                50% { transform: translate(-1px, 2px) rotate(-2deg); }
                60% { transform: translate(-3px, 1px) rotate(0deg); }
                70% { transform: translate(3px, 1px) rotate(-2deg); }
                80% { transform: translate(-1px, -1px) rotate(2deg); }
                90% { transform: translate(1px, 2px) rotate(0deg); }
                100% { transform: translate(1px, -2px) rotate(-2deg); }
            }

            .numbers {
                height: 20%;
                color: floralwhite;
                text-align: center;
            }

            .item {
                color: floralwhite;
                /* background: #1E1F26; */
                flex: 0 32%;
                /* min-height: 100px; */
                margin-bottom: 2%;
                margin-left: 5px;
                margin-right: 5px;
            }

            /* Ini adalah bahagian Card*/
            .cards {
                display: flex;
                flex-wrap: wrap;
                list-style: none;
                margin: 0;
                padding: 0;
            }

            .cards__item {
                display: flex;
                padding: 1rem;
                @media(min-width: 40rem) {
                    width: 50%;
                }
                @media(min-width: 56rem) {
                    width: 33.3333%;
                }
            }

            .card {
                background-color: white;
                border-radius: 0.25rem;
                box-shadow: 0 20px 40px -14px rgba(0,0,0,0.25);
                display: flex;
                flex-direction: column;
                overflow: hidden;
                &:hover {
                    .card__image {
                    filter: contrast(100%);
                    }
                }
            }

            .card__content {
                display: flex;
                flex: 1 1 auto;
                flex-direction: column;
                padding: 0;
            }

            .card__image {
                background-position: center center;
                background-repeat: no-repeat;
                background-size: cover;
                border-top-left-radius: 0.25rem;
                border-top-right-radius: 0.25rem;
                filter: contrast(70%);
                //filter: saturate(180%);
                overflow: hidden;
                position: relative;
                transition: filter 0.5s cubic-bezier(.43,.41,.22,.91);;
                &::before {
                    content: "";
                    display: block;
                    padding-top: 56.25%; // 16:9 aspect ratio
                }
                @media(min-width: 40rem) {
                    &::before {
                    padding-top: 66.6%; // 3:2 aspect ratio
                    }
                }
            }

            .card__image--flowers {
             background-image: url(https://unsplash.it/800/600?image=82);
            }

            .card__image--river {
                background-image: url(https://unsplash.it/800/600?image=11);
            }

            .card__image--record {
                background-image: url(https://unsplash.it/800/600?image=39);
            }

            .card__image--fence {
                background-image: url(https://unsplash.it/800/600?image=59);
            }

            .card__title {
                color: @gray-dark;
                
                font-weight: 300;
                letter-spacing: 2px;
                text-transform: uppercase;
            }

            .card__text {
                flex: 1 1 auto;
                font-size: 0.875rem;
                line-height: 1.5;
                margin-bottom: 1.25rem;
            }

            /* Here's some environment setup,
            scroll down for the interesting parts */

            @import url('https://fonts.googleapis.com/css?family=Lato:200');

            .animated-box {
            font-family: 'Lato';
            color: #ffffff;
            padding: 10px;
            text-align: center;
            border-radius: 4px;
            }

            .animated-box h1 {
            font-weight: 200;
            font-size: 40px;
            text-transform: uppercase;
            }

            .animated-box p {
            font-weight: 200;
            }

            /* The animation starts here */
            .animated-box {
            position: relative;
            }

            .animated-box:after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 4px;
            background: linear-gradient(120deg, #00F260, #0575E6, #00F260);
            background-size: 300% 300%;
            clip-path: polygon(0% 100%, 3px 100%, 3px 3px, calc(100% - 3px) 3px, calc(100% - 3px) calc(100% - 3px), 3px calc(100% - 3px), 3px 100%, 100% 100%, 100% 0%, 0% 0%);
            }

            .animated-box.in:after {
            animation: frame-enter 1s forwards ease-in-out reverse, gradient-animation 4s ease-in-out infinite;
            }

            /* motion */
            @keyframes gradient-animation {
            0% {
                background-position: 15% 0%;
            }
            50% {
                background-position: 85% 100%;
            }
            100% {
                background-position: 15% 0%;
            }
            }

            @keyframes frame-enter {
            0% {
                clip-path: polygon(0% 100%, 3px 100%, 3px 3px, calc(100% - 3px) 3px, calc(100% - 3px) calc(100% - 3px), 3px calc(100% - 3px), 3px 100%, 100% 100%, 100% 0%, 0% 0%);
            }
            25% {
                clip-path: polygon(0% 100%, 3px 100%, 3px 3px, calc(100% - 3px) 3px, calc(100% - 3px) calc(100% - 3px), calc(100% - 3px) calc(100% - 3px), calc(100% - 3px) 100%, 100% 100%, 100% 0%, 0% 0%);
            }
            50% {
                clip-path: polygon(0% 100%, 3px 100%, 3px 3px, calc(100% - 3px) 3px, calc(100% - 3px) 3px, calc(100% - 3px) 3px, calc(100% - 3px) 3px, calc(100% - 3px) 3px, 100% 0%, 0% 0%);
            }
            75% {
                -webkit-clip-path: polygon(0% 100%, 3px 100%, 3px 3px, 3px 3px, 3px 3px, 3px 3px, 3px 3px, 3px 3px, 3px 0%, 0% 0%);
            }
            100% {
                -webkit-clip-path: polygon(0% 100%, 3px 100%, 3px 100%, 3px 100%, 3px 100%, 3px 100%, 3px 100%, 3px 100%, 3px 100%, 0% 100%);
            }
            }

            #confetti{
                background: #000;
                height: 100%;
                left: 0px;
                position: fixed;
                top: 0px;
                width: 100%;
                z-index: -1;
            }

            .numGif{
                width: 600px !important;
                height: 100px !important;
            }
        </style>

    </head>
    <body class="antialiased">
        <canvas id="bg"></canvas>
        <div id="confetti" ></div>
        <div class="tablewrapper">
            <div class="cards">
                @foreach ($users as $key => $user)
                        <div class="item cards_item animated-box in">
                            <div class="card__content">
                                <div class="card__title" style="font-size: 1rem;">12.Senq Voucher</div>
                            </div>
                            <div class="card__image"><img id="placeholder{{ $key }}" src="img/gq.gif" alt="whut" class="gq {{ $gifts[$key]->type == 'grand' ? 'add_gold' : '' }}"></div>
                            <div class="card__content">
                                <div id="numVal{{ $key }}" class="card__title" style="font-size: 4rem;"><a href="" disabled hidden>{{ $user->id }}</a> </div>
                                <div id="numGif{{ $key }}" class="card__title"><img src="img/gift/num.gif" class="numGif" alt="num"> </div>
                            </div>
                        </div>
                        <input id="img{{ $key }}" name="img{{ $key }}" type="hidden" value="{{ $gifts[$key]->img }}"/>
                @endforeach
            </div>
            <div id="Button3" class="ud_solution">
                <a href="#" class="ud_button" id="b3" role="button">Press Here</a>
            </div>
        </div>
        <div>

        </div>

    </body>
</html>

<script src="{{asset('js/jquery-3.6.1.min.js')}}"></script>
<script src="{{asset('js/css-doodle.min.js')}}"></script>
<script src="{{asset('js/bootstrap.bundle.min.js')}}"></script>

<script>

    $("#confetti").hide();

    console.log(document.getElementById("img1").value);
    var b3 = document.getElementById("b3");
    const audio = new Audio("/sound/spin.mp3");
    // Code for Chrome, Safari and Opera
    b3.addEventListener("click", someSound);

    function someSound(){
        audio.play();
        b3.disabled = true;
        var element = document.getElementsByClassName('gq');

        for(let i = 0; i < element.length; i++){
            //console.log(element[i].classList.contains('gold'));
            //slot1 = setInterval(spin1, 50);

            if(element[i].classList.contains('add_gold')){
                element[i].classList.remove('shake_gq'); // reset animation
                void element[i].offsetWidth; // trigger reflow
                element[i].classList.add('shake_gq'); // start animation
                element[i].addEventListener("webkitAnimationEnd", function(){
                    element[i].classList.remove('shake_gq'); // reset animation
                    element[i].classList.remove('gold'); // reset animation
                    void element[i].offsetWidth; // trigger reflow
                    element[i].classList.add('gold'); // start animation
                    element[i].addEventListener("webkitAnimationEnd", function(){
                        changePic(i);
                        element[i].classList.remove('gold'); // start animation
                        element[i].src = "img/" + document.getElementById("img" + i).value;
                        element[i].style.height = '388px';
                        element[i].style.width = '600px';
                        element[i].src = "img/" + document.getElementById("numGif" + i).value;
                        element[i].src = "img/" + document.getElementById("numVal" + i).value;

                        console.log(document.getElementById("img" + i).value);
                    });
                });
            }else{
                element[i].classList.remove('blue'); // reset animation
                void element[i].offsetWidth; // trigger reflow
                element[i].classList.add('blue'); // start animation
                element[i].addEventListener("webkitAnimationEnd", function(){
                    element[i].src = "img/" + document.getElementById("img" + i).value;
                    element[i].style.height = '388px';
                    element[i].style.width = '600px';
                });
            }
        };
        b3.disabled = false;
    }

    var gq = document.getElementsByClassName("gq");
    console.log(gq);
    for(let i = 0; i < gq.length; i++){
        gq[i].addEventListener("webkitAnimationEnd", function(){
            changePic(i);
        });
        // gq[i].addEventListener("animationend", changePic(i));
    }

    function changePic(i){
        // var e = document.getElementById(i);
        var e = document.getElementsByClassName("gq");

        if (e[i].src.match("img/gq.gif") && e[i].classList.contains('shake_gq')) {
            e[i].src = "img/gq-sepia.gif";
        }
        else if(e[i].src.match("img/gq-sepia.gif")){
            e[i].src = "img/" + document.getElementById("img" + i).value;
        }
        else{
            e[i].src = "img/gq.gif";
        }
    }

      "use strict";
    // background animation
    (function() {

    var Base, Particle, canvas, colors, context, draw, drawables, i, mouseX, mouseY, mouseVX, mouseVY, rand, update, click, min, max, colors, particles;

    min = 1;
    max = 8;
    particles = 200;
    colors = ["64, 32, 0", "250, 64, 0", "64, 0, 0", "200, 200, 200"];

    rand = function(a, b) {
        return Math.random() * (b - a) + a;
    };

    Particle = (function() {
        function Particle() {
        this.reset();
        }

        Particle.prototype.reset = function() {
        this.color = colors[~~(Math.random()*colors.length)];
        this.radius = rand(min, max);
        this.x = rand(0, canvas.width);
        this.y = rand(-20, canvas.height*0.5);
        this.vx = -5 + Math.random()*10;
        this.vy = 0.7 * this.radius;
        this.valpha = rand(0.02, 0.09);
        this.opacity = 0;
        this.life = 0;
        this.onupdate = undefined;
        this.type = "dust";
        };

        Particle.prototype.update = function() {
        this.x = (this.x + this.vx/3);
        this.y = (this.y + this.vy/3);

        if(this.opacity >=1 && this.valpha > 0) this.valpha *=-1;
        this.opacity += this.valpha/3;
        this.life += this.valpha/3;

        if(this.type === "dust")
            this.opacity = Math.min(1, Math.max(0, this.opacity));
        else
            this.opacity = 1;

        if(this.onupdate) this.onupdate();
        if(this.life < 0 || this.radius <= 0 || this.y > canvas.height){
            this.onupdate = undefined;
            this.reset();
        }
        };

        Particle.prototype.draw = function(c) {
        c.strokeStyle = "rgba(" + this.color + ", " + Math.min(this.opacity, 0.85) + ")";
        c.fillStyle = "rgba(" + this.color + ", " + Math.min(this.opacity, 0.65) + ")";
        c.beginPath();
        c.arc(this.x, this.y, this.radius, 2 * Math.PI, false);
        c.fill();
        c.stroke();
        };

        return Particle;

    })();

    mouseVX = mouseVY = mouseX = mouseY = 0;

    canvas = document.getElementById("bg");
    context = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    drawables = (function() {
        var _i, _results;
        _results = [];
        for (i = _i = 1; _i <= particles; i = ++_i) {
        _results.push(new Particle);
        }
        return _results;
    })();

    draw = function() {
        var d, _i, _len;
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        context.clearRect(0, 0, canvas.width, canvas.height)

        for (_i = 0, _len = drawables.length; _i < _len; _i++) {
        d = drawables[_i];
        d.draw(context);
        }
    };

    update = function() {
        var d, _i, _len, _results;
        _results = [];
        for (_i = 0, _len = drawables.length; _i < _len; _i++) {
        d = drawables[_i];
        _results.push(d.update());
        }
        return _results;
    };

    document.onmousemove = function(e) {
        mouseVX = mouseX;
        mouseVY = mouseY;
        mouseX = ~~e.pageX;
        mouseY = ~~e.pageY;
        mouseVX = ~~((mouseVX - mouseX)/2);
        mouseVY = ~~((mouseVY - mouseY)/2);

    };

    window.addEventListener('resize', draw, false);
    setInterval(draw, 1000 / 30);
    setInterval(update, 1000 / 60);
    }).call(this);

    // Foregroudn animation (Confetti)

    /* Confetti by Patrik Svensson (http://metervara.net) */
$(document).ready(function() {
    var frameRate = 60;
    var dt = 1.0 / frameRate;
    var DEG_TO_RAD = Math.PI / 180;
    var RAD_TO_DEG = 180 / Math.PI;
    var colors = [
        ["#df0049", "#660671"],
        ["#00e857", "#005291"],
        ["#2bebbc", "#05798a"],
        ["#ffd200", "#b06c00"]
    ];

    function Vector2(_x, _y) {
        this.x = _x, this.y = _y;
        this.Length = function() {
            return Math.sqrt(this.SqrLength());
        }
        this.SqrLength = function() {
            return this.x * this.x + this.y * this.y;
        }
        this.Equals = function(_vec0, _vec1) {
            return _vec0.x == _vec1.x && _vec0.y == _vec1.y;
        }
        this.Add = function(_vec) {
            this.x += _vec.x;
            this.y += _vec.y;
        }
        this.Sub = function(_vec) {
            this.x -= _vec.x;
            this.y -= _vec.y;
        }
        this.Div = function(_f) {
            this.x /= _f;
            this.y /= _f;
        }
        this.Mul = function(_f) {
            this.x *= _f;
            this.y *= _f;
        }
        this.Normalize = function() {
            var sqrLen = this.SqrLength();
            if (sqrLen != 0) {
                var factor = 1.0 / Math.sqrt(sqrLen);
                this.x *= factor;
                this.y *= factor;
            }
        }
        this.Normalized = function() {
            var sqrLen = this.SqrLength();
            if (sqrLen != 0) {
                var factor = 1.0 / Math.sqrt(sqrLen);
                return new Vector2(this.x * factor, this.y * factor);
            }
            return new Vector2(0, 0);
        }
    }
    Vector2.Lerp = function(_vec0, _vec1, _t) {
        return new Vector2((_vec1.x - _vec0.x) * _t + _vec0.x, (_vec1.y - _vec0.y) * _t + _vec0.y);
    }
    Vector2.Distance = function(_vec0, _vec1) {
        return Math.sqrt(Vector2.SqrDistance(_vec0, _vec1));
    }
    Vector2.SqrDistance = function(_vec0, _vec1) {
        var x = _vec0.x - _vec1.x;
        var y = _vec0.y - _vec1.y;
        return (x * x + y * y + z * z);
    }
    Vector2.Scale = function(_vec0, _vec1) {
        return new Vector2(_vec0.x * _vec1.x, _vec0.y * _vec1.y);
    }
    Vector2.Min = function(_vec0, _vec1) {
        return new Vector2(Math.min(_vec0.x, _vec1.x), Math.min(_vec0.y, _vec1.y));
    }
    Vector2.Max = function(_vec0, _vec1) {
        return new Vector2(Math.max(_vec0.x, _vec1.x), Math.max(_vec0.y, _vec1.y));
    }
    Vector2.ClampMagnitude = function(_vec0, _len) {
        var vecNorm = _vec0.Normalized;
        return new Vector2(vecNorm.x * _len, vecNorm.y * _len);
    }
    Vector2.Sub = function(_vec0, _vec1) {
        return new Vector2(_vec0.x - _vec1.x, _vec0.y - _vec1.y, _vec0.z - _vec1.z);
    }

    function EulerMass(_x, _y, _mass, _drag) {
        this.position = new Vector2(_x, _y);
        this.mass = _mass;
        this.drag = _drag;
        this.force = new Vector2(0, 0);
        this.velocity = new Vector2(0, 0);
        this.AddForce = function(_f) {
            this.force.Add(_f);
        }
        this.Integrate = function(_dt) {
            var acc = this.CurrentForce(this.position);
            acc.Div(this.mass);
            var posDelta = new Vector2(this.velocity.x, this.velocity.y);
            posDelta.Mul(_dt);
            this.position.Add(posDelta);
            acc.Mul(_dt);
            this.velocity.Add(acc);
            this.force = new Vector2(0, 0);
        }
        this.CurrentForce = function(_pos, _vel) {
            var totalForce = new Vector2(this.force.x, this.force.y);
            var speed = this.velocity.Length();
            var dragVel = new Vector2(this.velocity.x, this.velocity.y);
            dragVel.Mul(this.drag * this.mass * speed);
            totalForce.Sub(dragVel);
            return totalForce;
        }
    }

    function ConfettiPaper(_x, _y) {
        this.pos = new Vector2(_x, _y);
        this.rotationSpeed = Math.random() * 600 + 800;
        this.angle = DEG_TO_RAD * Math.random() * 360;
        this.rotation = DEG_TO_RAD * Math.random() * 360;
        this.cosA = 1.0;
        this.size = 5.0;
        this.oscillationSpeed = Math.random() * 1.5 + 0.5;
        this.xSpeed = 40.0;
        this.ySpeed = Math.random() * 60 + 50.0;
        this.corners = new Array();
        this.time = Math.random();
        var ci = Math.round(Math.random() * (colors.length - 1));
        this.frontColor = colors[ci][0];
        this.backColor = colors[ci][1];
        for (var i = 0; i < 4; i++) {
            var dx = Math.cos(this.angle + DEG_TO_RAD * (i * 90 + 45));
            var dy = Math.sin(this.angle + DEG_TO_RAD * (i * 90 + 45));
            this.corners[i] = new Vector2(dx, dy);
        }
        this.Update = function(_dt) {
            this.time += _dt;
            this.rotation += this.rotationSpeed * _dt;
            this.cosA = Math.cos(DEG_TO_RAD * this.rotation);
            this.pos.x += Math.cos(this.time * this.oscillationSpeed) * this.xSpeed * _dt
            this.pos.y += this.ySpeed * _dt;
            if (this.pos.y > ConfettiPaper.bounds.y) {
                this.pos.x = Math.random() * ConfettiPaper.bounds.x;
                this.pos.y = 0;
            }
        }
        this.Draw = function(_g) {
            if (this.cosA > 0) {
                _g.fillStyle = this.frontColor;
            } else {
                _g.fillStyle = this.backColor;
            }
            _g.beginPath();
            _g.moveTo(this.pos.x + this.corners[0].x * this.size, this.pos.y + this.corners[0].y * this.size * this.cosA);
            for (var i = 1; i < 4; i++) {
                _g.lineTo(this.pos.x + this.corners[i].x * this.size, this.pos.y + this.corners[i].y * this.size * this.cosA);
            }
            _g.closePath();
            _g.fill();
        }
    }
    ConfettiPaper.bounds = new Vector2(0, 0);

    function ConfettiRibbon(_x, _y, _count, _dist, _thickness, _angle, _mass, _drag) {
        this.particleDist = _dist;
        this.particleCount = _count;
        this.particleMass = _mass;
        this.particleDrag = _drag;
        this.particles = new Array();
        var ci = Math.round(Math.random() * (colors.length - 1));
        this.frontColor = colors[ci][0];
        this.backColor = colors[ci][1];
        this.xOff = Math.cos(DEG_TO_RAD * _angle) * _thickness;
        this.yOff = Math.sin(DEG_TO_RAD * _angle) * _thickness;
        this.position = new Vector2(_x, _y);
        this.prevPosition = new Vector2(_x, _y);
        this.velocityInherit = Math.random() * 2 + 4;
        this.time = Math.random() * 100;
        this.oscillationSpeed = Math.random() * 2 + 2;
        this.oscillationDistance = Math.random() * 40 + 40;
        this.ySpeed = Math.random() * 40 + 80;
        for (var i = 0; i < this.particleCount; i++) {
            this.particles[i] = new EulerMass(_x, _y - i * this.particleDist, this.particleMass, this.particleDrag);
        }
        this.Update = function(_dt) {
            var i = 0;
            this.time += _dt * this.oscillationSpeed;
            this.position.y += this.ySpeed * _dt;
            this.position.x += Math.cos(this.time) * this.oscillationDistance * _dt;
            this.particles[0].position = this.position;
            var dX = this.prevPosition.x - this.position.x;
            var dY = this.prevPosition.y - this.position.y;
            var delta = Math.sqrt(dX * dX + dY * dY);
            this.prevPosition = new Vector2(this.position.x, this.position.y);
            for (i = 1; i < this.particleCount; i++) {
                var dirP = Vector2.Sub(this.particles[i - 1].position, this.particles[i].position);
                dirP.Normalize();
                dirP.Mul((delta / _dt) * this.velocityInherit);
                this.particles[i].AddForce(dirP);
            }
            for (i = 1; i < this.particleCount; i++) {
                this.particles[i].Integrate(_dt);
            }
            for (i = 1; i < this.particleCount; i++) {
                var rp2 = new Vector2(this.particles[i].position.x, this.particles[i].position.y);
                rp2.Sub(this.particles[i - 1].position);
                rp2.Normalize();
                rp2.Mul(this.particleDist);
                rp2.Add(this.particles[i - 1].position);
                this.particles[i].position = rp2;
            }
            if (this.position.y > ConfettiRibbon.bounds.y + this.particleDist * this.particleCount) {
                this.Reset();
            }
        }
        this.Reset = function() {
            this.position.y = -Math.random() * ConfettiRibbon.bounds.y;
            this.position.x = Math.random() * ConfettiRibbon.bounds.x;
            this.prevPosition = new Vector2(this.position.x, this.position.y);
            this.velocityInherit = Math.random() * 2 + 4;
            this.time = Math.random() * 100;
            this.oscillationSpeed = Math.random() * 2.0 + 1.5;
            this.oscillationDistance = Math.random() * 40 + 40;
            this.ySpeed = Math.random() * 40 + 80;
            var ci = Math.round(Math.random() * (colors.length - 1));
            this.frontColor = colors[ci][0];
            this.backColor = colors[ci][1];
            this.particles = new Array();
            for (var i = 0; i < this.particleCount; i++) {
                this.particles[i] = new EulerMass(this.position.x, this.position.y - i * this.particleDist, this.particleMass, this.particleDrag);
            }
        }
        this.Draw = function(_g) {
            for (var i = 0; i < this.particleCount - 1; i++) {
                var p0 = new Vector2(this.particles[i].position.x + this.xOff, this.particles[i].position.y + this.yOff);
                var p1 = new Vector2(this.particles[i + 1].position.x + this.xOff, this.particles[i + 1].position.y + this.yOff);
                if (this.Side(this.particles[i].position.x, this.particles[i].position.y, this.particles[i + 1].position.x, this.particles[i + 1].position.y, p1.x, p1.y) < 0) {
                    _g.fillStyle = this.frontColor;
                    _g.strokeStyle = this.frontColor;
                } else {
                    _g.fillStyle = this.backColor;
                    _g.strokeStyle = this.backColor;
                }
                if (i == 0) {
                    _g.beginPath();
                    _g.moveTo(this.particles[i].position.x, this.particles[i].position.y);
                    _g.lineTo(this.particles[i + 1].position.x, this.particles[i + 1].position.y);
                    _g.lineTo((this.particles[i + 1].position.x + p1.x) * 0.5, (this.particles[i + 1].position.y + p1.y) * 0.5);
                    _g.closePath();
                    _g.stroke();
                    _g.fill();
                    _g.beginPath();
                    _g.moveTo(p1.x, p1.y);
                    _g.lineTo(p0.x, p0.y);
                    _g.lineTo((this.particles[i + 1].position.x + p1.x) * 0.5, (this.particles[i + 1].position.y + p1.y) * 0.5);
                    _g.closePath();
                    _g.stroke();
                    _g.fill();
                } else if (i == this.particleCount - 2) {
                    _g.beginPath();
                    _g.moveTo(this.particles[i].position.x, this.particles[i].position.y);
                    _g.lineTo(this.particles[i + 1].position.x, this.particles[i + 1].position.y);
                    _g.lineTo((this.particles[i].position.x + p0.x) * 0.5, (this.particles[i].position.y + p0.y) * 0.5);
                    _g.closePath();
                    _g.stroke();
                    _g.fill();
                    _g.beginPath();
                    _g.moveTo(p1.x, p1.y);
                    _g.lineTo(p0.x, p0.y);
                    _g.lineTo((this.particles[i].position.x + p0.x) * 0.5, (this.particles[i].position.y + p0.y) * 0.5);
                    _g.closePath();
                    _g.stroke();
                    _g.fill();
                } else {
                    _g.beginPath();
                    _g.moveTo(this.particles[i].position.x, this.particles[i].position.y);
                    _g.lineTo(this.particles[i + 1].position.x, this.particles[i + 1].position.y);
                    _g.lineTo(p1.x, p1.y);
                    _g.lineTo(p0.x, p0.y);
                    _g.closePath();
                    _g.stroke();
                    _g.fill();
                }
            }
        }
        this.Side = function(x1, y1, x2, y2, x3, y3) {
            return ((x1 - x2) * (y3 - y2) - (y1 - y2) * (x3 - x2));
        }
    }
    ConfettiRibbon.bounds = new Vector2(0, 0);
    confetti = {};
    confetti.Context = function(parent) {
        var i = 0;
        var canvasParent = document.getElementById(parent);
        var canvas = document.createElement('canvas');
        canvas.width = canvasParent.offsetWidth;
        canvas.height = canvasParent.offsetHeight;
        canvasParent.appendChild(canvas);
        var context = canvas.getContext('2d');
        var interval = null;
        var confettiRibbonCount = 7;
        var rpCount = 30;
        var rpDist = 8.0;
        var rpThick = 8.0;
        var confettiRibbons = new Array();
        ConfettiRibbon.bounds = new Vector2(canvas.width, canvas.height);
        for (i = 0; i < confettiRibbonCount; i++) {
            confettiRibbons[i] = new ConfettiRibbon(Math.random() * canvas.width, -Math.random() * canvas.height * 2, rpCount, rpDist, rpThick, 45, 1, 0.05);
        }
        var confettiPaperCount = 25;
        var confettiPapers = new Array();
        ConfettiPaper.bounds = new Vector2(canvas.width, canvas.height);
        for (i = 0; i < confettiPaperCount; i++) {
            confettiPapers[i] = new ConfettiPaper(Math.random() * canvas.width, Math.random() * canvas.height);
        }
        this.resize = function() {
            canvas.width = canvasParent.offsetWidth;
            canvas.height = canvasParent.offsetHeight;
            ConfettiPaper.bounds = new Vector2(canvas.width, canvas.height);
            ConfettiRibbon.bounds = new Vector2(canvas.width, canvas.height);
        }
        this.start = function() {
            this.stop()
            var context = this
            this.interval = setInterval(function() {
                confetti.update();
            }, 1000.0 / frameRate)
        }
        this.stop = function() {
            clearInterval(this.interval);
        }
        this.update = function() {
            var i = 0;
            context.clearRect(0, 0, canvas.width, canvas.height);
            for (i = 0; i < confettiPaperCount; i++) {
                confettiPapers[i].Update(dt);
                confettiPapers[i].Draw(context);
            }
            for (i = 0; i < confettiRibbonCount; i++) {
                confettiRibbons[i].Update(dt);
                confettiRibbons[i].Draw(context);
            }
        }
    }
    var confetti = new confetti.Context('confetti');
    confetti.start();
    $(window).resize(function() {
        confetti.resize();
    });
});
</script>
